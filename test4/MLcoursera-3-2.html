<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>ML Coursera 3-2 Regularization</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- 웹 폰트 설정 -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/nanumgothic.css">
    <!-- syntax.css -->
    <link rel="stylesheet" href="/assets/built/syntax.css">
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />
    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->

    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="b Ha p" />
    <link rel="shortcut icon" href="https://hy38.github.io/assets/images/favicon.png" type="image/png" />
    <link rel="canonical" href="https://hy38.github.io/MLcoursera-3-2" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="HY38's IT Blog" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="ML Coursera 3-2 Regularization" />
    <meta property="og:description" content="Coursera Andrew Ng 교수님의 ML 강의를 정리한 포스트입니다. Regularization 이전 포스트를 끝으로 머신러닝의 회귀와 분류에 대해 알아보았습니다. 이제 우리는 Regularization 라고 하는 정규화에 대해 알아보겠습니다. Regularization이란, 근본적으로 Overfitting을 해결하기 위한 노력입니다. 그렇다면 오버피팅이란 무엇일까요? 단어를 뜯어보면, over(과하게, 많이) + fitting(피팅되다) 정도로 볼 수 있겠네요! 그렇습니다. 우리가 가설함수를 설정할 때 학습데이터를" />
    <meta property="og:url" content="https://hy38.github.io/MLcoursera-3-2" />
    <meta property="og:image" content="https://hy38.github.io/assets/images/ml.jpg" />
    <meta property="article:publisher" content="https://www.facebook.com/hy387" />
    <meta property="article:author" content="https://www.facebook.com/hy387" />
    <meta property="article:published_time" content="2019-07-12T19:00:00+09:00" />
    <meta property="article:modified_time" content="2019-07-12T19:00:00+09:00" />
    <meta property="article:tag" content="Machine Learning" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="ML Coursera 3-2 Regularization" />
    <meta name="twitter:description" content="Coursera Andrew Ng 교수님의 ML 강의를 정리한 포스트입니다. Regularization 이전 포스트를 끝으로 머신러닝의 회귀와 분류에 대해 알아보았습니다. 이제 우리는 Regularization 라고 하는 정규화에 대해 알아보겠습니다. Regularization이란, 근본적으로 Overfitting을 해결하기 위한 노력입니다. 그렇다면 오버피팅이란 무엇일까요? 단어를 뜯어보면, over(과하게, 많이) + fitting(피팅되다) 정도로 볼 수 있겠네요! 그렇습니다. 우리가 가설함수를 설정할 때 학습데이터를" />
    <meta name="twitter:url" content="https://hy38.github.io/" />
    <meta name="twitter:image" content="https://hy38.github.io/assets/images/ml.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="HY38's IT Blog" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Machine Learning" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "HY38's IT Blog",
        "logo": "https://hy38.github.io/"
    },
    "url": "https://hy38.github.io/MLcoursera-3-2",
    "image": {
        "@type": "ImageObject",
        "url": "https://hy38.github.io/assets/images/ml.jpg",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://hy38.github.io/MLcoursera-3-2"
    },
    "description": "Coursera Andrew Ng 교수님의 ML 강의를 정리한 포스트입니다. Regularization 이전 포스트를 끝으로 머신러닝의 회귀와 분류에 대해 알아보았습니다. 이제 우리는 Regularization 라고 하는 정규화에 대해 알아보겠습니다. Regularization이란, 근본적으로 Overfitting을 해결하기 위한 노력입니다. 그렇다면 오버피팅이란 무엇일까요? 단어를 뜯어보면, over(과하게, 많이) + fitting(피팅되다) 정도로 볼 수 있겠네요! 그렇습니다. 우리가 가설함수를 설정할 때 학습데이터를"
}
    </script>
    
<!-- katex -->
    <script data-ad-client="ca-pub-2887658471387992" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css"
  integrity="sha384-BdGj8xC2eZkQaxoQ8nSLefg4AV4/AwB3Fj+8SUSo7pnKP6Eoy18liIKTPn9oBYNG" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.js"
  integrity="sha384-JiKN5O8x9Hhs/UE5cT5AAJqieYlOZbGT3CHws/y97o3ty4R7/O5poG9F3JoiOYw1" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/contrib/auto-render.min.js"
  integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>

<script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true }, //  true : 가운데 정렬
        { left: "$", right: "$", display: false },
      ]
    });
  });
</script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="ML Coursera 3-2 Regularization" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://hy38.github.io/">HY38's IT Blog</a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-about" role="menuitem"><a href="/about/">About</a></li>
    <li class="nav-Algorithm" role="menuitem"><a href="/tag/algorithm/">Algorithm</a></li>
    <li class="nav-Theory" role="menuitem"><a href="/tag/theory/">Theory</a></li>
    <li class="nav-ML" role="menuitem"><a href="/tag/machine-learning/">ML</a></li>
    <li class="nav-ML" role="menuitem"><a href="/tag/deep-learning/">D2L</a></li>
    <!-- <li class="nav-try-ghost" role="menuitem"><a href="https://ghost.org">Try Ghost</a></li> -->
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            <a class="social-link social-link-gh" href="https://github.com/hy38" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="m12 2a10 10 0 0 0 -10 10c0 4.42 2.87 8.17 6.84 9.5 0.5 0.08 0.66-0.23 0.66-0.5v-1.69c-2.77 0.6-3.36-1.34-3.36-1.34-0.46-1.16-1.11-1.47-1.11-1.47-0.91-0.62 0.07-0.6 0.07-0.6 1 0.07 1.53 1.03 1.53 1.03 0.87 1.52 2.34 1.07 2.91 0.83 0.09-0.65 0.35-1.09 0.63-1.34-2.22-0.25-4.55-1.11-4.55-4.92 0-1.11 0.38-2 1.03-2.71-0.1-0.25-0.45-1.29 0.1-2.64 0 0 0.84-0.27 2.75 1.02 0.79-0.22 1.65-0.33 2.5-0.33s1.71 0.11 2.5 0.33c1.91-1.29 2.75-1.02 2.75-1.02 0.55 1.35 0.2 2.39 0.1 2.64 0.65 0.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91 0.36 0.31 0.69 0.92 0.69 1.85v2.74c0 0.27 0.16 0.59 0.67 0.5 3.97-1.34 6.83-5.08 6.83-9.5a10 10 0 0 0 -10 -10z"/>
  </svg></a>
            
            
                <a class="social-link social-link-fb" href="https://facebook.com/hy387" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
</a>
            
            
                <a class="social-link social-link-ig" href="https://instagram.com/hy387" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
    <path d="M256,49.471c67.266,0,75.233.257,101.8,1.469,24.562,1.121,37.9,5.224,46.778,8.674a78.052,78.052,0,0,1,28.966,18.845,78.052,78.052,0,0,1,18.845,28.966c3.45,8.877,7.554,22.216,8.674,46.778,1.212,26.565,1.469,34.532,1.469,101.8s-0.257,75.233-1.469,101.8c-1.121,24.562-5.225,37.9-8.674,46.778a83.427,83.427,0,0,1-47.811,47.811c-8.877,3.45-22.216,7.554-46.778,8.674-26.56,1.212-34.527,1.469-101.8,1.469s-75.237-.257-101.8-1.469c-24.562-1.121-37.9-5.225-46.778-8.674a78.051,78.051,0,0,1-28.966-18.845,78.053,78.053,0,0,1-18.845-28.966c-3.45-8.877-7.554-22.216-8.674-46.778-1.212-26.564-1.469-34.532-1.469-101.8s0.257-75.233,1.469-101.8c1.121-24.562,5.224-37.9,8.674-46.778A78.052,78.052,0,0,1,78.458,78.458a78.053,78.053,0,0,1,28.966-18.845c8.877-3.45,22.216-7.554,46.778-8.674,26.565-1.212,34.532-1.469,101.8-1.469m0-45.391c-68.418,0-77,.29-103.866,1.516-26.815,1.224-45.127,5.482-61.151,11.71a123.488,123.488,0,0,0-44.62,29.057A123.488,123.488,0,0,0,17.3,90.982C11.077,107.007,6.819,125.319,5.6,152.134,4.369,179,4.079,187.582,4.079,256S4.369,333,5.6,359.866c1.224,26.815,5.482,45.127,11.71,61.151a123.489,123.489,0,0,0,29.057,44.62,123.486,123.486,0,0,0,44.62,29.057c16.025,6.228,34.337,10.486,61.151,11.71,26.87,1.226,35.449,1.516,103.866,1.516s77-.29,103.866-1.516c26.815-1.224,45.127-5.482,61.151-11.71a128.817,128.817,0,0,0,73.677-73.677c6.228-16.025,10.486-34.337,11.71-61.151,1.226-26.87,1.516-35.449,1.516-103.866s-0.29-77-1.516-103.866c-1.224-26.815-5.482-45.127-11.71-61.151a123.486,123.486,0,0,0-29.057-44.62A123.487,123.487,0,0,0,421.018,17.3C404.993,11.077,386.681,6.819,359.866,5.6,333,4.369,324.418,4.079,256,4.079h0Z"/>
    <path d="M256,126.635A129.365,129.365,0,1,0,385.365,256,129.365,129.365,0,0,0,256,126.635Zm0,213.338A83.973,83.973,0,1,1,339.974,256,83.974,83.974,0,0,1,256,339.973Z"/>
    <circle cx="390.476" cy="121.524" r="30.23"/>
  </svg></a>
            
                <!--  -->
        </div>
        
            <!-- <a class="subscribe-button" href="https://hy38.github.io/search.html">Search</a> -->
            <a class="subscribe-button" href="https://hy38.github.io/search.html">Search</a>
            <!-- <a class="subscribe-button" href="#subscribe">Search</a> -->
        
    </div>
</nav>

    </div>
</header>

<!-- Google Adsense -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 사각형 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2887658471387992"
     data-ad-slot="1484718312"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full post tag-getting-started ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="12 July 2019">12 July 2019</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/machine-learning/'>MACHINE LEARNING</a>,
                            
                        
                            
                               <a href='/tag/coursera/'>COURSERA</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">ML Coursera 3-2 Regularization</h1>
            </header>

            
            <figure class="post-full-image" style="background-image: url(/assets/images/ml.jpg)">
            </figure>
            

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <blockquote>
  <p>Coursera Andrew Ng 교수님의 ML 강의를 정리한 포스트입니다.</p>
</blockquote>

<h1 id="regularization">Regularization</h1>

<p>이전 포스트를 끝으로 머신러닝의 회귀와 분류에 대해 알아보았습니다. 이제 우리는 <strong>Regularization</strong> 라고 하는 정규화에 대해 알아보겠습니다.</p>

<p>Regularization이란, 근본적으로 <strong>Overfitting</strong>을 해결하기 위한 노력입니다. 그렇다면 오버피팅이란 무엇일까요? 단어를 뜯어보면, 
over(과하게, 많이) + fitting(피팅되다) 정도로 볼 수 있겠네요! 그렇습니다. 우리가 가설함수를 설정할 때 학습데이터를 너무 잘 <strong>끼워맞추기</strong> 위해
과하게 fitting하는 것이 오버피팅입니다. 여기서 “과하게” 라는것은 가설함수를 너무 복잡하게 설정한다는 것을 의미합니다. 그런데 여기서 학습데이터를
잘 맞추면 좋은것 아닌가요? 라고 할 수 있겠지만, 아쉽게도 오버피팅의 본질적인 문제점은 학습데이터 <strong>“만”</strong> 잘 맞추고, 시험용데이터나 실전에서는 낮은
정확도를 보인다는 것입니다.반대로 <strong>Underfitting</strong> 또한 존재합니다. 언더피팅은 너무 간단한 가설함수를 설정하면 발생하는 문제입니다. 
이들을 그림으로 확인하면 다음과 같습니다.</p>

<p><img src="/assets/images/ml/coursera/week3/over-under-fitting-image.png" alt="over_under_fitting_image" /></p>

<p>위의 linear regression가설함수가 복잡해짐에 따라 학습용데이터가 잘 fitting되는것을 확인할 수 있습니다. 물론 다음과 같은 Logistic Regression에서도 마찬가지로 발생합니다.</p>

<p><img src="/assets/images/ml/coursera/week3/over-under-fitting-logistic-image.png" alt="over_under_fitting_logistic_image" /></p>

<h2 id="addressing-overfitting">Addressing Overfitting</h2>

<p>오버피팅을 다루는 방법은 크게 3가지가 있습니다.</p>
<ul>
  <li>첫째, 더 많은 학습데이터를 이용하여 가설함수를 훈련한다.</li>
  <li>둘째, feature의 수를 줄인다.
    <ul>
      <li>이 경우 수동으로 feature들을 제거하는데, data loss를 최소화하는 지워질 feature들을 고른다. 물론 이럼에도 data loss는 발생한다.</li>
    </ul>
  </li>
  <li>셋째, Regularization을 이용한다.
    <ul>
      <li>모든 feature들을 남겨두지만, 매개변수 $\theta$의 크기를 감소시킨다. 이는 각각 조금씩 y결과값 예측에 기여하는 feaeture가 많을 때 유용하다.</li>
    </ul>
  </li>
</ul>

<p>이중에서 우리는 세번째 방법인 Regularization을 이용하여 Overfitting을 해결해볼 것입니다. 
위의 오버피팅된 linear regression 집값예측 그래프를 Regularize하는 것을 설명하겠습니다.
먼저, $\theta$의 크기를 줄이기 위해서 cost function을 다음과 같이 수정합니다. $\theta_3$와 $\theta_4$의 크기를 줄이기(penalize) 위함인데요,</p>

<p><img src="/assets/images/ml/coursera/week3/modified-cost-function.png" alt="modified_cost_function" /></p>

<p>$\theta_3$와 $\theta_4$의 크기가 많이 줄게 되면 다음 두 항 $\theta_3 x^3$와 $\theta_4 x^4$의 영향력이 거의 사라집니다. 그럼 결국에는 2차다항식만이
남아있는것처럼 보이게됩니다.</p>

<p><img src="/assets/images/ml/coursera/week3/linear-regression-regularization.png" alt="linear_regression_regularization" /></p>

<p>cost function에 큰 계수가 붙은 theta를 추가하였을뿐인데, 이것이 어떤 방식으로 theta의 크기를 감소시키는것일까요?</p>

<p>Cost function은 우리가 최소화해야하는 함수입니다. 그 함수에 엄청나게 큰 계수를 달고있는 $\theta$들을 포함시키게 되면, 기존과 같은 값의 theta들로는
cost function J를 키우기만 할 뿐, 줄이는데 성공하지 못할것입니다. 따라서 J를 minimize하는 $\theta$들 중 큰 계수를 달고 들어온 penalize당하는 
새로운 항들($\theta$)은 자연스럽게 크기가 작아질 수 밖에 없게됩니다. J를 최소화해야하기 때문입니다.</p>

<p>이로인해 우리는 더욱 간단한 2차다항식의 형태의 hypothesis function을 얻게됩니다.</p>

<p>정리하면 다음과 같습니다.</p>
<ul>
  <li>penalize위해 Cost function에 항들을 추가함.</li>
  <li>Cost function을 minimize하는 과정에서 $\theta_3$와 $\theta_4$의 크기가 줄어들게됨.</li>
  <li>그러다보니 간단한 hypothesis가 완성되는것처럼 됨.</li>
</ul>

<p>이번에는, 특정 $\theta$를 penalize하는것이 아닌, $\theta_0$을 제외한 다른 모든 $\theta$들을 penalize하는 방법입니다. 이는 어떤 항들을 penalize해야할지를 고르지 못하는 상황에서 사용합니다.
따라서 이 경우의 항들이 추가된 Cost function은 다음과 같습니다.</p>

<script type="math/tex; mode=display">J(\theta) = {1 \over 2m} * [\sum_{i=1}^m(h_\theta(x^{(i)})-y^{(i)})^2 + \lambda\sum_{i=1}^n\theta_i^2]</script>

<p>관습적으로 $\theta_0$는 penalize하지 않는다고 합니다. 사실 $\theta_0$를 penalize하더라도 유의미한 차이가 없다고 하네요. 위와같은 식을 사용하게 되면 이전보다 부드러운 곡선이 등장하게됩니다. data fitting도 잘되고 hypothesis function도 훨씬 좋아집니다.</p>

<p>위 식에서 새로 보는 문자가 하나 등장합니다. 바로 $\lambda$인데요, 이를 <strong>regularization parameter</strong>라고 합니다. 우리는 이 $\lambda$를 조절하며 얼마나 regularize할지를 정하는데요, 이 람다가 0이라면, 기존의 일반적인 cost function이 만들어지며, 이는 overfitting이 유지가됩니다. 만일, 람다가 200같이 너무 큰 수로 지정되면, 반대로 세타들을 너무 penalize하게되어 underfitting이 발생하게 됩니다. 이보다 더 큰 수를 람다로 지정하게 되면, penalize하지 않는 $\theta_0$를 제외한 모든 $\theta$들이 거의 없는듯한 효과를 보이게 되므로 $h_\theta(x) = \theta_0$인 상수함수만 남은것처럼 보이게 됩니다.
따라서 regularization parameter $\lambda$를 잘 선택하는것이 중요합니다.</p>

<h2 id="regularized-linear-regression">Regularized Linear Regression</h2>

<p>위에서 regularization을 이용한 linear regression의 cost function $J(\theta)$에 대해 살펴보았습니다. 이전과 마찬가지로 $J(\theta)$를 minimize하는 $\theta$를 찾아야합니다. 이때, gradient descent를 사용하는데, 우선 이전의 기존 linear regression의 gradient descent식은 다음과 같습니다.</p>

<p><img src="/assets/images/ml/coursera/week3/regularized-linear-gradient.png" alt="regularized_linear_gradient" /></p>

<p>여기서 $\theta_0$를 구별해준 것을 알 수 있습니다. $\theta_0$를 penalize하지 않기 때문에 구별한것입니다.</p>

<p>위 식의 $\theta_j$ 식에 다음과 같이 ${\lambda \over m}\theta_j$을 추가해줍니다. 참고로 이 식은 cost function $J(\theta)$의 편미분 결과입니다.</p>

<p>이 떄, 위 $\theta_j$의 update 식을 $\theta_j(1 - \alpha{\lambda \over m})$로 묶어낼 수 있습니다. 
여기서 다음 항을 주목할 필요가 있습니다.</p>

<script type="math/tex; mode=display">(1 - \alpha{\lambda \over m})</script>

<p>주로 alpha는 작은수, m은 큰 수이기 때문에, 위 항은 1보다 작게됩니다. 주로 0.95 ~ 0.99 사이의 값들을 갖게 되는데, 이 수치들을 $\theta_j$에 매 update시마다 곱해주게 됩니다. 그 이외의 항은 기존 gradient descent와 동일합니다.</p>

<p>이를 통해 보다 직관적으로 $\theta_j$를 매 update마다 감소시킴을 알 수 있습니다. $\theta$값들의 penalize가 이렇게 작동합니다.</p>

<h3 id="regularization-with-the-normal-equation">Regularization with the Normal Equation</h3>

<p>$J(\theta)$를 minimize하기위한 방법중 하나인 normal equation을 이용한 방법으로도 regularization을 진행할 수 있습니다. 기존의 linear regression의 normal equation식은 다음과 같았습니다.</p>

<script type="math/tex; mode=display">\theta = (X^TX)^{-1}X^Ty</script>

<p>기억이 안나시면 <a href="/ml/MLcoursera-2-1/">여기</a>를 참고해주세요!</p>

<p>위 기존 normal equation에서 다음과 같이 항을 추가하여 regularization을 진행하게 됩니다.</p>

<p><img src="/assets/images/ml/coursera/week3/normal-equation-regularization.png" alt="normal_equation_regularization" /></p>

<p>위 추가된 항인 $\lambda[matrix]$에서 행렬의 첫번째 원소가 0인 이유는 j=0일 때 $\theta_j$를 penalize하지 않기 위함입니다.</p>

<p>Normal Equation을 이용할 때 항상 고려하게 되는것이 바로 <strong>Non-invertibility</strong>인데요, 딱히 고려할 필요가 없어집니다.
그 이유는, $(X^TX + \lambda[matrix])$가 항상 invertible하기 때문입니다.</p>

<p>따라서, 기존의 $X^TX$항이 $m \le n$ 이면 invertible하다는 조건을 따질 필요가 없어졌습니다. 여러모로 regularization을 이용하면 좋아지네요!</p>

<h2 id="regularization-for-logistic-regression">Regularization for Logistic Regression</h2>

<p>마지막으로 Logistic Regression에서의 Regularization에 대해 살펴보겠습니다.
Logistic Regression을 regularize하는 과정이 Linear Regression과 비슷합니다.</p>

<p>먼저 cost function $J(\theta)$에 다음 항을 추가합니다.</p>

<script type="math/tex; mode=display">+{\lambda \over 2m}\sum_{j=1}^n\theta_j^2</script>

<p>완성된 $J(\theta)$는 다음과 같습니다.</p>

<p><img src="/assets/images/ml/coursera/week3/regularized-logistic-cost-function.PNG" alt="regularized_logistic_cost_function" /></p>

<p>추가된 항의 sum이 j=1부터 시작됨을 유의해주세요. 이는 j=0일 때의 $\theta_0$를 penalize하지 않겠다는 뜻입니다.</p>

<p>이제 cost function J에 gradient descent를 적용해보겠습니다.</p>

<p>기존의 logistic regression의 $\theta$ update rule은 다음과 같았습니다.</p>

<p><img src="/assets/images/ml/coursera/week3/original-logistic-gradient-descent.png" alt="original_logistic_gradient_descent" /></p>

<p>여기서 linear regression과 동일한 방법으로 다음과 같은 식을 유도할 수 있습니다.</p>

<p><img src="/assets/images/ml/coursera/week3/modified-logistic-gradient-descent.png" alt="modified_logistic_gradient_descent" /></p>

<p>위 $\theta$ update rule이 regularized linear regression과 동일하게됨을 알 수 있습니다. 
<strong>다만, 가설함수가 다르기 때문에, 식만 같을뿐이지, 실제로 동일하지는 않습니다.</strong></p>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            <!-- <h3 class="subscribe-form-title">Subscribe to HY38's IT Blog</h3>
            <p>Get the latest posts delivered right to your inbox</p> -->
            <!-- 
                <section class="subscribe-form">
                    <h3 class="subscribe-form-title">Search Posts from HY38's IT Blog</h3>
                    <p>After pressing Enter, you will be leaded to search page. <br>
                        You should press <strong>CTRL</strong> to search after then.</p>
                    <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()"
               id="searchtext" type="text" name="searchtext"
               placeholder="Search by title / tag .." />
    </div>
    
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                // location.href = "search.html?query=" + url;
                location.href = "/search.html?query=" + url;

                // location.href = "/search.html";
            }
        }
    </script>
</span>

                </section>
             -->

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/images/hy38-main-picture2.jpg" alt="hy38" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/author/hy38">Sanghyun Park</a></h4>
                                
                                    <p>Sanghyun Park is a student majoring Computer Science & Engineering, Chungnam National University, Korea.</p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/author/hy38">Read More</a>
                        </div>
                    
                
                <!-- /author  -->
            </footer>

                <section class="post-full-comments">
                    <div id="disqus_thread"></div>
                    <script>
                        var disqus_config = function () {
                            this.page.url = 'https://hy38.github.io/MLcoursera-3-2';
                            this.page.identifier = '/MLcoursera-3-2';
                            this.page.title = 'HY38\'s IT Blog';    //  hardcoded due to backslash
                        };
                        (function() {
                            var d = document, s = d.createElement('script');
                            s.src = 'https://hy38.disqus.com/embed.js';
                            s.setAttribute('data-timestamp', +new Date());
                            (d.head || d.body).appendChild(s);
                        })();
                    </script>
                </section>

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/images/blog-cover.jpg)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; HY38's IT Blog &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/machine-learning/">Machine learning</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/MLcoursera-6-1">ML Coursera 6-1 Advice for Applying Machine Learning</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/MLcoursera-5-1">ML Coursera 5-1 Neural Networks - Learning</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/MLcoursera-4-1">ML Coursera 4-1 Neural Networks - Representation</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/machine-learning/">
                                
                                    See all 7 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/MLcoursera-4-1">
                <div class="post-card-image" style="background-image: url(/assets/images/ml.jpg)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/MLcoursera-4-1">
                <header class="post-card-header">
                    
                        
                            
                               <span class="post-card-tags">Machine learning</span>
                            
                        
                            
                                <span class="post-card-tags">Coursera</span>
                            
                        
                    

                    <h2 class="post-card-title">ML Coursera 4-1 Neural Networks - Representation</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p></p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/hy38-main-picture2.jpg" alt="Sanghyun Park" />
                        
                        <span class="post-card-author">
                            <a href="/author/hy38/">Sanghyun Park</a>
                        </span>
                    
                
                <span class="reading-time">
                    
                    
                      1 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/D2L-3-image-classification-implementation-from-scratch">
                <div class="post-card-image" style="background-image: url(/assets/images/d2l/artificial-neural-network.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/D2L-3-image-classification-implementation-from-scratch">
                <header class="post-card-header">
                    
                        
                            
                               <span class="post-card-tags">Deep learning</span>
                            
                        
                            
                                <span class="post-card-tags">Image classification</span>
                            
                        
                    

                    <h2 class="post-card-title">D2L 3 - Image Classification Implementation from Scratch</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p></p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/hy38-main-picture2.jpg" alt="Sanghyun Park" />
                        
                        <span class="post-card-author">
                            <a href="/author/hy38/">Sanghyun Park</a>
                        </span>
                    
                
                <span class="reading-time">
                    
                    
                      1 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://hy38.github.io/">
            
                <img src="/assets/images/favicon.png" alt="HY38's IT Blog icon" />
            
            <span>HY38's IT Blog</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">ML Coursera 3-2 Regularization</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=ML+Coursera+3-2+Regularization&amp;url=https://hy38.github.ioMLcoursera-3-2"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://hy38.github.ioMLcoursera-3-2"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://hy38.github.io/">HY38's IT Blog</a> &copy; 2020</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyller/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    <a href="https://facebook.com/hy387" target="_blank" rel="noopener">Facebook</a>
                    
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
        <div id="subscribe" class="subscribe-overlay">
            <a class="subscribe-overlay-close" href="#"></a>
            <div class="subscribe-overlay-content">
                
                <h1 class="subscribe-overlay-title">Subscribe to HY38's IT Blog</h1>
                <p class="subscribe-overlay-description">Stay up to date! Get all the latest &amp; greatest posts delivered straight to your inbox</p>
                <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()"
               id="searchtext" type="text" name="searchtext"
               placeholder="Search by title / tag .." />
    </div>
    
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                // location.href = "search.html?query=" + url;
                location.href = "/search.html?query=" + url;

                // location.href = "/search.html";
            }
        }
    </script>
</span>

            </div>
        </div>
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-134670325-1', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>