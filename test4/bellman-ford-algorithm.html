<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>벨만 포드 최단경로 알고리즘의 구현 - Bellman-Ford Shortest Path Algorithm</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- 웹 폰트 설정 -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/nanumgothic.css">
    <!-- syntax.css -->
    <link rel="stylesheet" href="/assets/built/syntax.css">
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />
    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->

    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="b Ha p" />
    <link rel="shortcut icon" href="https://hy38.github.io/assets/images/favicon.png" type="image/png" />
    <link rel="canonical" href="https://hy38.github.io/bellman-ford-algorithm" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="HY38's IT Blog" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="벨만 포드 최단경로 알고리즘의 구현 - Bellman-Ford Shortest Path Algorithm" />
    <meta property="og:description" content="벨만-포드 최단 경로 알고리즘 그래프의 최단경로 알고리즘 그래프의 최단경로 알고리즘에 대한 설명은 여기에서 확인할 수 있다. 최단거리 알고리즘의 종류들과 edge relaxation에 대해 설명한다. 최단경로 알고리즘과 edge relaxation에 대해 자세히 알지 못한다면, 여기에서 먼저 알아보는 것이 좋을것 같다. 음수간선은 OK, 가중치의 합이 음수인 사이클은 NO! 다익스트라 알고리즘과 달리 벨만-포드 알고리즘은 음수" />
    <meta property="og:url" content="https://hy38.github.io/bellman-ford-algorithm" />
    <meta property="og:image" content="https://hy38.github.io/assets/images/algorithm/green-red-arrow.jpg" />
    <meta property="article:publisher" content="https://www.facebook.com/hy387" />
    <meta property="article:author" content="https://www.facebook.com/hy387" />
    <meta property="article:published_time" content="2020-04-25T04:00:00+09:00" />
    <meta property="article:modified_time" content="2020-04-25T04:00:00+09:00" />
    <meta property="article:tag" content="Algorithm" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="벨만 포드 최단경로 알고리즘의 구현 - Bellman-Ford Shortest Path Algorithm" />
    <meta name="twitter:description" content="벨만-포드 최단 경로 알고리즘 그래프의 최단경로 알고리즘 그래프의 최단경로 알고리즘에 대한 설명은 여기에서 확인할 수 있다. 최단거리 알고리즘의 종류들과 edge relaxation에 대해 설명한다. 최단경로 알고리즘과 edge relaxation에 대해 자세히 알지 못한다면, 여기에서 먼저 알아보는 것이 좋을것 같다. 음수간선은 OK, 가중치의 합이 음수인 사이클은 NO! 다익스트라 알고리즘과 달리 벨만-포드 알고리즘은 음수" />
    <meta name="twitter:url" content="https://hy38.github.io/" />
    <meta name="twitter:image" content="https://hy38.github.io/assets/images/algorithm/green-red-arrow.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="HY38's IT Blog" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Algorithm" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "HY38's IT Blog",
        "logo": "https://hy38.github.io/"
    },
    "url": "https://hy38.github.io/bellman-ford-algorithm",
    "image": {
        "@type": "ImageObject",
        "url": "https://hy38.github.io/assets/images/algorithm/green-red-arrow.jpg",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://hy38.github.io/bellman-ford-algorithm"
    },
    "description": "벨만-포드 최단 경로 알고리즘 그래프의 최단경로 알고리즘 그래프의 최단경로 알고리즘에 대한 설명은 여기에서 확인할 수 있다. 최단거리 알고리즘의 종류들과 edge relaxation에 대해 설명한다. 최단경로 알고리즘과 edge relaxation에 대해 자세히 알지 못한다면, 여기에서 먼저 알아보는 것이 좋을것 같다. 음수간선은 OK, 가중치의 합이 음수인 사이클은 NO! 다익스트라 알고리즘과 달리 벨만-포드 알고리즘은 음수"
}
    </script>
    
<!-- katex -->
    <script data-ad-client="ca-pub-2887658471387992" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css"
  integrity="sha384-BdGj8xC2eZkQaxoQ8nSLefg4AV4/AwB3Fj+8SUSo7pnKP6Eoy18liIKTPn9oBYNG" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.js"
  integrity="sha384-JiKN5O8x9Hhs/UE5cT5AAJqieYlOZbGT3CHws/y97o3ty4R7/O5poG9F3JoiOYw1" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/contrib/auto-render.min.js"
  integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>

<script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true }, //  true : 가운데 정렬
        { left: "$", right: "$", display: false },
      ]
    });
  });
</script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="벨만 포드 최단경로 알고리즘의 구현 - Bellman-Ford Shortest Path Algorithm" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://hy38.github.io/">HY38's IT Blog</a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-about" role="menuitem"><a href="/about/">About</a></li>
    <li class="nav-Algorithm" role="menuitem"><a href="/tag/algorithm/">Algorithm</a></li>
    <li class="nav-Theory" role="menuitem"><a href="/tag/theory/">Theory</a></li>
    <li class="nav-ML" role="menuitem"><a href="/tag/machine-learning/">ML</a></li>
    <li class="nav-ML" role="menuitem"><a href="/tag/deep-learning/">D2L</a></li>
    <!-- <li class="nav-try-ghost" role="menuitem"><a href="https://ghost.org">Try Ghost</a></li> -->
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            <a class="social-link social-link-gh" href="https://github.com/hy38" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="m12 2a10 10 0 0 0 -10 10c0 4.42 2.87 8.17 6.84 9.5 0.5 0.08 0.66-0.23 0.66-0.5v-1.69c-2.77 0.6-3.36-1.34-3.36-1.34-0.46-1.16-1.11-1.47-1.11-1.47-0.91-0.62 0.07-0.6 0.07-0.6 1 0.07 1.53 1.03 1.53 1.03 0.87 1.52 2.34 1.07 2.91 0.83 0.09-0.65 0.35-1.09 0.63-1.34-2.22-0.25-4.55-1.11-4.55-4.92 0-1.11 0.38-2 1.03-2.71-0.1-0.25-0.45-1.29 0.1-2.64 0 0 0.84-0.27 2.75 1.02 0.79-0.22 1.65-0.33 2.5-0.33s1.71 0.11 2.5 0.33c1.91-1.29 2.75-1.02 2.75-1.02 0.55 1.35 0.2 2.39 0.1 2.64 0.65 0.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91 0.36 0.31 0.69 0.92 0.69 1.85v2.74c0 0.27 0.16 0.59 0.67 0.5 3.97-1.34 6.83-5.08 6.83-9.5a10 10 0 0 0 -10 -10z"/>
  </svg></a>
            
            
                <a class="social-link social-link-fb" href="https://facebook.com/hy387" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
</a>
            
            
                <a class="social-link social-link-ig" href="https://instagram.com/hy387" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
    <path d="M256,49.471c67.266,0,75.233.257,101.8,1.469,24.562,1.121,37.9,5.224,46.778,8.674a78.052,78.052,0,0,1,28.966,18.845,78.052,78.052,0,0,1,18.845,28.966c3.45,8.877,7.554,22.216,8.674,46.778,1.212,26.565,1.469,34.532,1.469,101.8s-0.257,75.233-1.469,101.8c-1.121,24.562-5.225,37.9-8.674,46.778a83.427,83.427,0,0,1-47.811,47.811c-8.877,3.45-22.216,7.554-46.778,8.674-26.56,1.212-34.527,1.469-101.8,1.469s-75.237-.257-101.8-1.469c-24.562-1.121-37.9-5.225-46.778-8.674a78.051,78.051,0,0,1-28.966-18.845,78.053,78.053,0,0,1-18.845-28.966c-3.45-8.877-7.554-22.216-8.674-46.778-1.212-26.564-1.469-34.532-1.469-101.8s0.257-75.233,1.469-101.8c1.121-24.562,5.224-37.9,8.674-46.778A78.052,78.052,0,0,1,78.458,78.458a78.053,78.053,0,0,1,28.966-18.845c8.877-3.45,22.216-7.554,46.778-8.674,26.565-1.212,34.532-1.469,101.8-1.469m0-45.391c-68.418,0-77,.29-103.866,1.516-26.815,1.224-45.127,5.482-61.151,11.71a123.488,123.488,0,0,0-44.62,29.057A123.488,123.488,0,0,0,17.3,90.982C11.077,107.007,6.819,125.319,5.6,152.134,4.369,179,4.079,187.582,4.079,256S4.369,333,5.6,359.866c1.224,26.815,5.482,45.127,11.71,61.151a123.489,123.489,0,0,0,29.057,44.62,123.486,123.486,0,0,0,44.62,29.057c16.025,6.228,34.337,10.486,61.151,11.71,26.87,1.226,35.449,1.516,103.866,1.516s77-.29,103.866-1.516c26.815-1.224,45.127-5.482,61.151-11.71a128.817,128.817,0,0,0,73.677-73.677c6.228-16.025,10.486-34.337,11.71-61.151,1.226-26.87,1.516-35.449,1.516-103.866s-0.29-77-1.516-103.866c-1.224-26.815-5.482-45.127-11.71-61.151a123.486,123.486,0,0,0-29.057-44.62A123.487,123.487,0,0,0,421.018,17.3C404.993,11.077,386.681,6.819,359.866,5.6,333,4.369,324.418,4.079,256,4.079h0Z"/>
    <path d="M256,126.635A129.365,129.365,0,1,0,385.365,256,129.365,129.365,0,0,0,256,126.635Zm0,213.338A83.973,83.973,0,1,1,339.974,256,83.974,83.974,0,0,1,256,339.973Z"/>
    <circle cx="390.476" cy="121.524" r="30.23"/>
  </svg></a>
            
                <!--  -->
        </div>
        
            <!-- <a class="subscribe-button" href="https://hy38.github.io/search.html">Search</a> -->
            <a class="subscribe-button" href="https://hy38.github.io/search.html">Search</a>
            <!-- <a class="subscribe-button" href="#subscribe">Search</a> -->
        
    </div>
</nav>

    </div>
</header>

<!-- Google Adsense -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 사각형 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2887658471387992"
     data-ad-slot="1484718312"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full post tag-getting-started ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="25 April 2020">25 April 2020</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/algorithm/'>ALGORITHM</a>,
                            
                        
                            
                               <a href='/tag/theory/'>THEORY</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">벨만 포드 최단경로 알고리즘의 구현 - Bellman-Ford Shortest Path Algorithm</h1>
            </header>

            
            <figure class="post-full-image" style="background-image: url(/assets/images/algorithm/green-red-arrow.jpg)">
            </figure>
            

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <blockquote>
  <p>벨만-포드 최단 경로 알고리즘</p>
</blockquote>

<h4 id="그래프의-최단경로-알고리즘">그래프의 최단경로 알고리즘</h4>

<p>그래프의 최단경로 알고리즘에 대한 설명은 <a href="/about-Shortest-Path" target="_blank"><strong>여기</strong></a>에서 확인할 수 있다. 최단거리 알고리즘의 종류들과 <code class="highlighter-rouge">edge relaxation</code>에 대해 설명한다.</p>

<blockquote>
  <p>최단경로 알고리즘과 edge relaxation에 대해 자세히 알지 못한다면, <a href="/about-Shortest-Path" target="_blank"><strong>여기</strong></a>에서 먼저 알아보는 것이 좋을것 같다.</p>
</blockquote>

<hr />

<h6 id="음수간선은-ok-가중치의-합이-음수인-사이클은-no">음수간선은 OK, 가중치의 합이 음수인 사이클은 NO!</h6>

<p><a href="/dijkstra-algorithm" target="_blank">다익스트라</a> 알고리즘과 달리 벨만-포드 알고리즘은 음수 간선이 존재해도 제대로 작동한다.</p>

<p>다익스트라의 대안으로 벨만-포드 알고리즘을 사용하는 이유이다.</p>

<p>다만, 가중치의 합이 음수인 사이클은 벨만-포드 알고리즘으로 하여금 제대로된 최단 경로를 찾을 수 없게한다. (보다 자세한 설명은 <a href="/why-dijkstra-fail-on-a-negative-weighted-edge" target="_blank"><strong>여기</strong></a>에서 서술하는 3가지 이유 중 첫번째 이유를 참조하면 될것같다.)</p>

<p><strong>닿을 수 없는 정점의 음수 사이클은 무시한다. 닿을 수 없는 정점에서의 사이클을 신경쓸 필요가 전혀 없기 때문이다.</strong> 아래에서 닿을 수 없는 정점이 이루는 음수 사이클을 무시하는 방법을 살펴볼 것이다.</p>

<hr />

<h6 id="기본적인-아이디어">기본적인 아이디어</h6>

<p>다익스트라는 최단 경로는 최단경로로 구성되어있다는데에 출발하였다.</p>

<p>반면, 벨만-포드는 최단경로를 예측하고 점차 <strong>오차를 줄여나가는</strong> 아이디어를 사용한다.</p>

<p>따라서 배열 선언부터 <code class="highlighter-rouge">dist</code>대신 <code class="highlighter-rouge">upper</code>이라는 이름으로 선언한다. 이는 단일 시작점 <code class="highlighter-rouge">s</code>에서 각 정점까지의 경로들의 <code class="highlighter-rouge">상한값</code>을 담은 배열으로 사용된다.</p>

<p><code class="highlighter-rouge">상한값</code>이라는 말이 어렵지만, 벨만 포드가 사용하는 최단 경로의 특성을 알면 이해하기 수월하다.</p>

<ul>
  <li>최단경로 dist[u]와 dist[v]에 대해 다음의 특성이 항상 성립한다.</li>
</ul>

<p>$ dist[v] \leq dist[u] + w(u, v) $</p>

<p>이로인해 <code class="highlighter-rouge">dist[v]</code>가 될 수 있는 <code class="highlighter-rouge">dist[u] + w(u, v)</code>는 모두 <code class="highlighter-rouge">dist[v]</code>보다 크거나 같다.</p>

<p>최단경로와 가까운 값들을 구해나가며 최종적인 최단 경로를 찾아가는 방식으로 동작하기에 <code class="highlighter-rouge">상한값</code>이라는 단어가 쓰인다.</p>

<p>총 <code class="highlighter-rouge">V-1번</code> 반복하여 모든 정점들에 대한 최단경로를 알아낼 수 있으며, 한 번씩 그래프의 모든 간선을 완화할 경우 최소 한개의 정점에 대한 최단 경로값이 발견된다.</p>

<p>계속되는 완화를 통해 <code class="highlighter-rouge">upper</code> 배열이 우리가 원하는 <code class="highlighter-rouge">dist</code> 배열이 되도록 한다.</p>

<hr />

<h4 id="벨만-포드-알고리즘의-edge-relaxation">벨만-포드 알고리즘의 Edge Relaxation</h4>

<h6 id="edge-relaxation의-동작-과정">Edge Relaxation의 동작 과정</h6>

<p>첫번째로 진행하는 모든 간선에 대한 완화에 대해 시작 정점인 <code class="highlighter-rouge">1번</code> 정점에서부터 그 인접 정점들 <code class="highlighter-rouge">v</code>에 대한 최단 경로가 다음과 같이 구해진다.</p>

<p>위에서 설명한 최단경로의 특성을 이용하면,</p>

<p>$ upper[v] \leq upper[1] + w(1, v) $ 가 항상 성립하고,</p>

<p>$upper[1] = 0$ 이기에 $ upper[v] \leq w(1, v) $가 된다.</p>

<p>이 때, 자연스럽게 w(1, v)는 <code class="highlighter-rouge">1번</code> 정점에서 <code class="highlighter-rouge">v번</code> 정점까지의 최단경로이며, 이로 인해 <code class="highlighter-rouge">v번</code> 정점의 최단경로가 구해진다.</p>

<p>이는 처음 <code class="highlighter-rouge">1번</code> 정점의 최단경로가 <code class="highlighter-rouge">0</code>임을 확신할 수 있었기에 가능했으며, 확신할 수 있게된 <code class="highlighter-rouge">v번</code> 정점의 최단경로를 이용하여 이와 비슷하게 다른 정점의 최단경로를 구할 수 있다.</p>

<p>이 작업의 연쇄를 통해 모든 정점의 최단 경로를 구한다.</p>

<ul>
  <li>
    <p>다음 그림을 통해 연쇄 작업을 이해할 수 있다.</p>
  </li>
  <li>
    <p>점으로 표시된 정점은 최단경로가 보장된 정점이다. 최악의 경우 총 <code class="highlighter-rouge">V-1번</code>인 4번의 <code class="highlighter-rouge">Edge Relaxation</code>이 진행됨을 알 수 있다.</p>
  </li>
</ul>

<p><img src="/assets/images/algorithm/bellman-ford-graph3.png" alt="bellman_ford_graph3" /></p>

<ul>
  <li>최단경로가 구해지는 반복 횟수 및 순서는 그래프의 모양 및 간선의 입력 순서 등에 따라 달라질 수 있다. 다음 그림이 예시이다.</li>
</ul>

<p><img src="/assets/images/algorithm/bellman-ford-graph2.png" alt="bellman_ford_graph2" /></p>

<h6 id="edge-relaxation의-반복-횟수">Edge Relaxation의 반복 횟수</h6>

<blockquote>
  <p>총 <strong>V-1번</strong>의 Edge Relaxation을 진행한다.</p>
</blockquote>

<ul>
  <li>
    <p><code class="highlighter-rouge">1번</code> 정점부터 <code class="highlighter-rouge">V번</code> 정점까지 인접리스트를 이용하여 그래프의 모든 간선의 완화를 진행한다.</p>
  </li>
  <li>
    <p>모든 간선을 한번씩 완화했다는 것은, 최소 하나의 정점의 최단경로가 구해졌다는 것이다.</p>
  </li>
  <li>
    <p>이를 총 <code class="highlighter-rouge">V-1번</code> 반복한다.</p>
  </li>
</ul>

<hr />

<h4 id="벨만-포드-알고리즘의-구현코드">벨만-포드 알고리즘의 구현(코드)</h4>

<p><code class="highlighter-rouge">1번</code> 정점에서 시작하여 다른 <code class="highlighter-rouge">2 ~ V번</code> 정점들까지의 각각의 최단거리를 계산한다.</p>

<ul>
  <li>C++ Code</li>
</ul>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;vector&gt;
#include &lt;iostream&gt;
</span>
<span class="cp">#define INF 987654321
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">V</span><span class="p">,</span> <span class="n">edges</span><span class="p">;</span>
<span class="kt">bool</span> <span class="n">isCyclic</span><span class="p">;</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">adj</span><span class="p">[</span><span class="mi">502</span><span class="p">];</span>

<span class="kt">void</span> <span class="nf">input</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">cin</span><span class="p">.</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>

    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">V</span> <span class="o">&gt;&gt;</span> <span class="n">edges</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">edges</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">w</span><span class="p">;</span>
        <span class="n">adj</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">bellmanFord</span><span class="p">(</span><span class="kt">int</span> <span class="n">src</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//  시작점을 제외한 모든 정점까지의 최단 거리 상한을 INF로 둔다.
</span>    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">upper</span><span class="p">(</span><span class="n">V</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">INF</span><span class="p">);</span>
    <span class="n">upper</span><span class="p">[</span><span class="n">src</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">updated</span><span class="p">;</span>

    <span class="c1">//  V번 순회한다.
</span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">iter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">iter</span> <span class="o">&lt;</span> <span class="n">V</span><span class="p">;</span> <span class="o">++</span><span class="n">iter</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">updated</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">node</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">node</span> <span class="o">&lt;=</span> <span class="n">V</span><span class="p">;</span> <span class="o">++</span><span class="n">node</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">==</span> <span class="n">INF</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>   <span class="c1">//  닿을수 없는 정점을 건너띔으로써 해당 정점에서 발생하는 사이클을 무시한다.
</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">adj</span><span class="p">[</span><span class="n">node</span><span class="p">].</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="kt">int</span> <span class="n">next</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">;</span>
                <span class="kt">int</span> <span class="n">cost</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">;</span>

                <span class="c1">//  (node, next) 간선을 따라 완화를 시도한다.
</span>                <span class="k">if</span> <span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="n">next</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">+</span> <span class="n">cost</span><span class="p">)</span> <span class="p">{</span>
                    <span class="c1">//  성공
</span>                    <span class="n">upper</span><span class="p">[</span><span class="n">next</span><span class="p">]</span> <span class="o">=</span> <span class="n">upper</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">+</span> <span class="n">cost</span><span class="p">;</span>
                    <span class="n">updated</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="c1">//  모든 간선에 대해 완화가 실패했을 경우 V-1번도 돌 필요 없이 곧장 종료한다.
</span>        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">updated</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">//  V번째 순회에서도 완화가 성공했다면 음수 사이클이 있다.
</span>    <span class="k">if</span> <span class="p">(</span><span class="n">updated</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">isNegativeCycle</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
        <span class="n">upper</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">upper</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>

    <span class="n">input</span><span class="p">();</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">dist</span> <span class="o">=</span> <span class="n">bellmanFord</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">isNegativeCycle</span><span class="p">)</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"-1</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">V</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">900000000</span><span class="p">)</span>
                <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"-1</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
            <span class="k">else</span>
                <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<h4 id="updated-변수의-2가지-쓰임">updated 변수의 2가지 쓰임</h4>

<h6 id="1-모든-정점의-최단경로가-구해진-경우의-탈출">1. 모든 정점의 최단경로가 구해진 경우의 탈출</h6>

<p>모든 간선에 대해 완화 시도를 하였지만 실패한 경우는 모든 정점의 <code class="highlighter-rouge">상한값 upper</code>이 <code class="highlighter-rouge">최단경로 dist</code>에 수렴했다는 것을 의미한다.</p>

<p>이는 더이상의 간선 검사를 무의미하게 만들며, 곧바로 종료를 시킴으로써 시간을 절약할 수 있게된다.</p>

<p>이 때 사용하는 변수가 <code class="highlighter-rouge">updated</code>라는 <code class="highlighter-rouge">boolean</code> 변수이다.</p>

<p>V번 반복하는 도중에 <code class="highlighter-rouge">updated</code>가 <code class="highlighter-rouge">true</code>로 바뀌지 않는 경우에는 <code class="highlighter-rouge">break</code>를 통해 곧바로 for문을 탈출한다.</p>

<h6 id="2-가중치의-합이-음수인-사이클의-존재-여부">2. 가중치의 합이 음수인 사이클의 존재 여부</h6>

<blockquote>
  <p>벨만-포드 알고리즘의 장점은 음수 가중치 간선이 존재할 때에도 작동한다는 것일뿐만 아니라, <strong>(닿을 수 있는) 음수 사이클이 존재하는지</strong>를 알려준다는 것이다.
이 역시 <code class="highlighter-rouge">updated</code>를 이용하여 판별한다.</p>
</blockquote>

<p>모든 최단경로를 계산하는데에는 <code class="highlighter-rouge">V-1</code>번의 반복이면 충분하지만, 한번 더 반복을 진행하여 총 <code class="highlighter-rouge">V번</code> 반복을 시켜준다.</p>

<p>이렇게 되면 이미 <code class="highlighter-rouge">V-1</code>번째 반복에 의해 모든 최단경로가 구해져있지만, 음수 사이클이 존재하는 경우 <code class="highlighter-rouge">edge relaxation</code>이 진행됨을 알 수 있다.</p>

<p>이 경우에 <code class="highlighter-rouge">updated</code>를 <code class="highlighter-rouge">true</code>로 설정해주면 다음과 같은 조건문을 사용하여 음수 사이클 여부를 체크할 수 있다.</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">//  V번째 순회에서도 완화가 성공했다면 음수 사이클이 있다.
</span>    <span class="k">if</span> <span class="p">(</span><span class="n">updated</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">isNegativeCycle</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
        <span class="n">upper</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>  <span class="c1">//  음수 사이클이 존재하여 최단 경로를 구할 수 없다.
</span>    <span class="p">}</span>
</code></pre></div></div>

<p>최단경로가 <code class="highlighter-rouge">V-1번</code> 이전에 모두 구해져 <code class="highlighter-rouge">break</code>를 통해 탈출한 경우에는 <code class="highlighter-rouge">updated</code>가 <code class="highlighter-rouge">false</code>인 상태이기 때문에 위의 음수 사이클을 찾는 코드에 걸리지 않는다.</p>

<hr />

<h4 id="두-가지-문제점과-한-가지-해결-방법">두 가지 문제점과 한 가지 해결 방법</h4>

<p>1) 출발점에서 도달 불가능한 음수 사이클</p>

<p>출발점에서 도달 불가능한 정점들이 가중치의 합이 음수인 사이클을 이루고 있는 경우가 존재한다.</p>

<p>이 경우 원래는 도달 가능한 정점들에 대해 <code class="highlighter-rouge">upper</code>을 출력하고, 도달 불가능한 정점들에 대해 <code class="highlighter-rouge">UNREACHABLE</code> 혹은 <code class="highlighter-rouge">-1</code>등의 처리를 해야한다.</p>

<p>하지만, V번째 반복에서 도달 불가능한 정점들의 음수 사이클을 발견하고 <code class="highlighter-rouge">isNegativeCycle</code>을 <code class="highlighter-rouge">true</code>로 바꾸게되는 경우에 <code class="highlighter-rouge">UNREACHABLE</code>과 <code class="highlighter-rouge">-1</code>이 아닌 <code class="highlighter-rouge">음수 사이클이 존재하므로 거리를 구할수 없음</code> 처리를 해버리는 경우가 존재한다.</p>

<p>따라서 도달 불가능한 정점들을 무시하는 등의 처리가 필요하다.</p>

<p>2) 도달 불가능한 정점의 식별시 주의사항</p>

<p>도달불가능한 정점들 <code class="highlighter-rouge">v</code>가 음의 가중치를 갖는 간선을 보유하고 있을 경우의 문제점이 존재한다.</p>

<p>모든 간선들을 그래프의 정점 갯수번만큼 완화를 진행할 때 위의 경우에 <code class="highlighter-rouge">upper[v]</code>가 <code class="highlighter-rouge">INF</code>가 아니라 <strong>INF보다 작은 값으로</strong> 완화된다.</p>

<p>따라서 도달 불가능한 정점들을 찾을때 <code class="highlighter-rouge">if(upper[v] == INF)</code>라는 코드는 제대로 작동하지 않을 수 있다.</p>

<p>적당히 큰 수 M을 잡아 <code class="highlighter-rouge">if(upper[v] &gt;= (INF - M)</code>으로 코드를 수정해주어 도달 불가능한 정점들을 제대로 식별할 수 있다.</p>

<ul>
  <li>한 가지 간단한 해결 방법</li>
</ul>

<p>우선, 벨만-포드 알고리즘이 <em>‘Single Source Shortest Path’</em> 알고리즘임을 기억하자.<a href="/about-Shortest-Path" target="_blank">(관련 포스트)</a></p>

<p>이는 즉 <code class="highlighter-rouge">src</code>에서 도달할 수 없는 정점들은 신경쓰지 않아도 된다는 것을 의미한다.</p>

<p>따라서 과감하게 도달할 수 없는 정점들을 무시해버리자.</p>

<p>도달할 수 없는 정점들을 무시하면, 알고리즘의 <code class="highlighter-rouge">V번</code>째 반복에서 <code class="highlighter-rouge">isNegativeCycle</code>이 <code class="highlighter-rouge">true</code>가 될 일이 없다.</p>

<p>다만, 어떻게 이 정점들을 무시할 수 있을까?</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">iter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">iter</span> <span class="o">&lt;</span> <span class="n">V</span><span class="p">;</span> <span class="o">++</span><span class="n">iter</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">updated</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">node</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">node</span> <span class="o">&lt;=</span> <span class="n">V</span><span class="p">;</span> <span class="o">++</span><span class="n">node</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">==</span> <span class="n">INF</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>   <span class="c1">//  닿을수 없는 정점을 건너띔으로써 해당 정점에서 발생하는 사이클을 무시한다.
</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">adj</span><span class="p">[</span><span class="n">node</span><span class="p">].</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="kt">int</span> <span class="n">next</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">;</span>
                <span class="kt">int</span> <span class="n">cost</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">;</span>

                <span class="c1">//  (node, next) 간선을 따라 완화를 시도한다.
</span>                <span class="k">if</span> <span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="n">next</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">+</span> <span class="n">cost</span><span class="p">)</span> <span class="p">{</span>
                    <span class="c1">//  성공
</span>                    <span class="n">upper</span><span class="p">[</span><span class="n">next</span><span class="p">]</span> <span class="o">=</span> <span class="n">upper</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">+</span> <span class="n">cost</span><span class="p">;</span>
                    <span class="n">updated</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="c1">//  모든 간선에 대해 완화가 실패했을 경우 V-1번도 돌 필요 없이 곧장 종료한다.
</span>        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">updated</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>두번째 for문의 다음 코드를 주목하자.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if(upper[node] == INF) continue;
</code></pre></div></div>

<p>이러면 모든 정점들에 대해 건너띄는것이 아닌가 생각이 들겠지만, 우리는 시작 정점인 <code class="highlighter-rouge">1번</code> 정점의 upper값을 <code class="highlighter-rouge">0</code>으로 지정해준 상태이다.</p>

<p>따라서 <code class="highlighter-rouge">1번</code> 정점과 연결된 모든 정점들의 완화가 진행된다.</p>

<p><code class="highlighter-rouge">1번</code> 정점과 연결되어있지 않은 정점들은 위 <code class="highlighter-rouge">continue</code> 코드에 의해 upper값이 <code class="highlighter-rouge">INF</code>로 남아있을 것이다.</p>

<p>이를 통해 자연스럽게 <code class="highlighter-rouge">src</code>에서 도달할 수 없는 정점들을 건너띄게 된다.</p>

<p>이로써 첫번째 문제를 해결하였다. 이제 두번째 문제를 해결하면 된다. 공교롭게도 두번째 문제는 자동으로 해결된다.</p>

<p>도달할 수 없는 정점들을 건너띄었으므로, 도달 불가능한 정점들끼리의 완화가 진행될 경우가 없고, 따라서 두번째 문제인 도달 불가능한 정점의 식별시 주의사항또한 지킬 필요가 없어졌다!</p>

<p>따라서 더이상 <code class="highlighter-rouge">INF</code>값에 적당한 수를 빼는 수고를 하지 않아도 된다.</p>

<p>한 줄의 코드로 두개의 문제사항을 해결한 셈이다.</p>

<hr />

<h4 id="시간-복잡도의-계산">시간 복잡도의 계산</h4>

<p>이 알고리즘에서 3중 for문이 사용된다.</p>

<ul>
  <li>
    <p>두번째, 세번째 for문은 시작정점인 <code class="highlighter-rouge">1번</code>정점부터 <code class="highlighter-rouge">V번</code>정점까지 각각 <code class="highlighter-rouge">edge relaxation</code>을 진행한다. 이때 <strong>그래프의 모든 간선을 검사</strong>하므로 <code class="highlighter-rouge">O(E)</code></p>
  </li>
  <li>
    <p>첫번째 for문은 위 과정을 <code class="highlighter-rouge">V번</code>만큼 반복한다. 음수 사이클 여부가 중요하지 않다면 <code class="highlighter-rouge">V-1번</code> 반복하겠지만 시간복잡도는 어쨌든 <code class="highlighter-rouge">O(V)</code></p>
  </li>
</ul>

<p>따라서 벨만-포드 알고리즘의 최종 시간복잡도는 $O(VE)$가 된다.</p>

<hr />

<h6 id="관련-문제">관련 문제</h6>

<ul>
  <li>
    <p><a href="https://www.acmicpc.net/problem/11657" target="_blank">BOJ 11657 - 타임머신</a></p>
  </li>
  <li>
    <p><a href="https://www.acmicpc.net/problem/1865" target="_blank">BOJ 1865 - 웜홀</a></p>
  </li>
</ul>

<hr />

<h4 id="참고-사항">참고 사항</h4>

<p>PS에서는 많은 사람들이 벨만-포드 알고리즘을 다음과 같이 간단하게 구현한다.</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kt">bool</span> <span class="n">minusCycle</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
    <span class="n">fill</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">dist</span><span class="o">+</span><span class="n">N</span><span class="p">,</span> <span class="n">INF</span><span class="p">);</span>
    <span class="n">dist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="n">p</span><span class="o">:</span> <span class="n">adj</span><span class="p">[</span><span class="n">j</span><span class="p">]){</span>
                <span class="kt">int</span> <span class="n">next</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">first</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="n">INF</span> <span class="o">&amp;&amp;</span> <span class="n">dist</span><span class="p">[</span><span class="n">next</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">){</span>
                    <span class="n">dist</span><span class="p">[</span><span class="n">next</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">;</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">N</span><span class="p">)</span> <span class="n">minusCycle</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="references">References</h2>

<ul>
  <li>
    <p>Introduction to Algorithms</p>
  </li>
  <li>
    <p>알고리즘 문제 해결 전략 2</p>
  </li>
  <li>
    <p><a href="https://bluemoon-1st.tistory.com/17" target="_blank">https://bluemoon-1st.tistory.com/17</a></p>
  </li>
  <li>
    <p><a href="https://www.crocus.co.kr/534" target="_blank">https://www.crocus.co.kr/534</a></p>
  </li>
  <li>
    <p><a href="https://ratsgo.github.io/data%20structure&amp;algorithm/2017/11/27/bellmanford/" target="_blank">https://ratsgo.github.io/data%20structure&amp;algorithm/2017/11/27/bellmanford/</a></p>
  </li>
</ul>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            <!-- <h3 class="subscribe-form-title">Subscribe to HY38's IT Blog</h3>
            <p>Get the latest posts delivered right to your inbox</p> -->
            <!-- 
                <section class="subscribe-form">
                    <h3 class="subscribe-form-title">Search Posts from HY38's IT Blog</h3>
                    <p>After pressing Enter, you will be leaded to search page. <br>
                        You should press <strong>CTRL</strong> to search after then.</p>
                    <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()"
               id="searchtext" type="text" name="searchtext"
               placeholder="Search by title / tag .." />
    </div>
    
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                // location.href = "search.html?query=" + url;
                location.href = "/search.html?query=" + url;

                // location.href = "/search.html";
            }
        }
    </script>
</span>

                </section>
             -->

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/images/hy38-main-picture2.jpg" alt="hy38" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/author/hy38">Sanghyun Park</a></h4>
                                
                                    <p>Sanghyun Park is a student majoring Computer Science & Engineering, Chungnam National University, Korea.</p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/author/hy38">Read More</a>
                        </div>
                    
                
                <!-- /author  -->
            </footer>

                <section class="post-full-comments">
                    <div id="disqus_thread"></div>
                    <script>
                        var disqus_config = function () {
                            this.page.url = 'https://hy38.github.io/bellman-ford-algorithm';
                            this.page.identifier = '/bellman-ford-algorithm';
                            this.page.title = 'HY38\'s IT Blog';    //  hardcoded due to backslash
                        };
                        (function() {
                            var d = document, s = d.createElement('script');
                            s.src = 'https://hy38.disqus.com/embed.js';
                            s.setAttribute('data-timestamp', +new Date());
                            (d.head || d.body).appendChild(s);
                        })();
                    </script>
                </section>

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/images/blog-cover.jpg)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; HY38's IT Blog &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/algorithm/">Algorithm</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/floyd-warshall-algorithm">플로이드 워셜 최단경로 알고리즘의 구현 - Floyd-Warshall Shortest Path Algorithm</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/dijkstra-algorithm">다익스트라 최단경로 알고리즘의 구현 - Dijkstra Shortest Path Algorithm</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/why-dijkstra-fail-on-a-negative-weighted-edge">다익스트라 알고리즘에서 음수 간선이 존재하면 안되는 이유 - Reason Why Dijkstra Fail on a Negative Weighted Edge</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/algorithm/">
                                
                                    See all 19 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/floyd-warshall-algorithm">
                <div class="post-card-image" style="background-image: url(/assets/images/algorithm/road.jpg)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/floyd-warshall-algorithm">
                <header class="post-card-header">
                    
                        
                            
                               <span class="post-card-tags">Algorithm</span>
                            
                        
                            
                                <span class="post-card-tags">Theory</span>
                            
                        
                    

                    <h2 class="post-card-title">플로이드 워셜 최단경로 알고리즘의 구현 - Floyd-Warshall Shortest Path Algorithm</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p></p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/hy38-main-picture2.jpg" alt="Sanghyun Park" />
                        
                        <span class="post-card-author">
                            <a href="/author/hy38/">Sanghyun Park</a>
                        </span>
                    
                
                <span class="reading-time">
                    
                    
                      1 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/dijkstra-algorithm">
                <div class="post-card-image" style="background-image: url(/assets/images/algorithm/crystal.jpg)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/dijkstra-algorithm">
                <header class="post-card-header">
                    
                        
                            
                               <span class="post-card-tags">Algorithm</span>
                            
                        
                            
                                <span class="post-card-tags">Theory</span>
                            
                        
                    

                    <h2 class="post-card-title">다익스트라 최단경로 알고리즘의 구현 - Dijkstra Shortest Path Algorithm</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p></p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/hy38-main-picture2.jpg" alt="Sanghyun Park" />
                        
                        <span class="post-card-author">
                            <a href="/author/hy38/">Sanghyun Park</a>
                        </span>
                    
                
                <span class="reading-time">
                    
                    
                      1 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://hy38.github.io/">
            
                <img src="/assets/images/favicon.png" alt="HY38's IT Blog icon" />
            
            <span>HY38's IT Blog</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">벨만 포드 최단경로 알고리즘의 구현 - Bellman-Ford Shortest Path Algorithm</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=%EB%B2%A8%EB%A7%8C+%ED%8F%AC%EB%93%9C+%EC%B5%9C%EB%8B%A8%EA%B2%BD%EB%A1%9C+%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98%EC%9D%98+%EA%B5%AC%ED%98%84+-+Bellman-Ford+Shortest+Path+Algorithm&amp;url=https://hy38.github.iobellman-ford-algorithm"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://hy38.github.iobellman-ford-algorithm"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://hy38.github.io/">HY38's IT Blog</a> &copy; 2020</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyller/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    <a href="https://facebook.com/hy387" target="_blank" rel="noopener">Facebook</a>
                    
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
        <div id="subscribe" class="subscribe-overlay">
            <a class="subscribe-overlay-close" href="#"></a>
            <div class="subscribe-overlay-content">
                
                <h1 class="subscribe-overlay-title">Subscribe to HY38's IT Blog</h1>
                <p class="subscribe-overlay-description">Stay up to date! Get all the latest &amp; greatest posts delivered straight to your inbox</p>
                <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()"
               id="searchtext" type="text" name="searchtext"
               placeholder="Search by title / tag .." />
    </div>
    
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                // location.href = "search.html?query=" + url;
                location.href = "/search.html?query=" + url;

                // location.href = "/search.html";
            }
        }
    </script>
</span>

            </div>
        </div>
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-134670325-1', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>